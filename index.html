
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>📸 上傳進貨發票／收據</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 2em; background: #f9f9f9; }
    h1 { font-size: 1.5em; margin-bottom: 1em; }
    input[type="file"] { margin: 1em 0; }
    .preview { max-width: 300px; margin: auto; }
    .upload-status { font-size: 1.2em; margin-top: 1em; color: #e91e63; }
    button { padding: 1em 2em; font-size: 1em; background-color: #eee; border: none; border-radius: 8px; cursor: pointer; }
    button:hover { background-color: #ddd; }
  </style>
</head>
<body>
  <h1>📸 上傳進貨發票／收據</h1>
  <form id="uploadForm" action="https://script.google.com/macros/s/AKfycbwwu5YOGPKWg18lmQHmyfcvB7es_BtC_O1Bc1x63MjNeiiTc3MMl0MF0EAdMDHjt9Se/exec" method="post" enctype="multipart/form-data">
    <input type="file" name="file" accept="image/*" required onchange="previewImage(event)">
    <div class="preview">
      <img id="preview" src="" alt="圖片預覽" style="width: 100%; display: none;" />
    </div>
    <button type="submit">📤 上傳圖片</button>
  </form>
  <div class="upload-status" id="status"></div>
  <script>
    function previewImage(event) {
      const reader = new FileReader();
      reader.onload = function () {
        const output = document.getElementById('preview');
        output.src = reader.result;
        output.style.display = 'block';
      };
      reader.readAsDataURL(event.target.files[0]);
    }

    document.getElementById("uploadForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const statusDiv = document.getElementById("status");

      fetch(form.action, {
        method: "POST",
        body: formData,
      })
        .then((res) => {
          if (res.ok) {
            statusDiv.textContent = "✅ 上傳成功";
            statusDiv.style.color = "green";
            form.reset();
            document.getElementById("preview").style.display = "none";
          } else {
            throw new Error("上傳失敗");
          }
        })
        .catch((err) => {
          statusDiv.textContent = "❌ 上傳失敗";
          statusDiv.style.color = "#e91e63";
        });
    });
  </script>
</body>
</html>
